<span class="breadcrumb">
	<a (click)="onItemSelected('dashboard')">{{'dashboard.home' | translate}} &nbsp;&nbsp;</a> > &nbsp;&nbsp;<a
		(click)="onItemSelected('uinservices/dashboard')">{{'dashboard.uinservices' | translate}} &nbsp;&nbsp;</a> >
	&nbsp;&nbsp;<span class="active">{{'viewhistory.title' | translate}}</span>
</span>

<div class="main-div" *ngIf="langJSON">
	<mat-card>
		<h3 style="color: #505050; font-size:20px;">{{'viewhistory.title' | translate}}</h3>
		<table *ngIf="responselist" style="width: 100%;">
			<tr>
				<td style="width: 16%;padding: 10px;"><span class="label">{{'viewhistory.inputsearch' | translate}}</span></td>
				<td style="width: 16%;padding: 10px;"><span class="label">{{'viewhistory.inputHistory' | translate}}</span></td>
				<td style="width: 16%;padding: 10px;"><span class="label">{{'viewhistory.inputFrom' | translate}}</span></td>
				<td style="width: 16%;padding: 10px;"><span class="label">{{'viewhistory.inputTo' | translate}}</span></td>
				<td style="width: 16%;padding: 10px;"><span class="label">{{'viewhistory.inputStatus' | translate}}</span></td>			
				<td style="width: 20%;padding: 10px;"></td>
			</tr>
			<tr style="vertical-align: baseline;">
				<td style="width: 16%;padding: 10px;">
					<input type="text" id="appIdValue" name="appIdValue" style="margin-bottom: 1.2rem;"
						(blur)="captureValue($event, 'searchText', 'textbox')"
						placeholder="{{'viewhistory.inputAppId' | translate}}" />
				</td>
				<td style="width: 16%;padding: 10px;">
					<mat-select multiple placeholder="{{'viewhistory.inputHistory' | translate}}"
						(selectionChange)="captureValue($event, 'serviceType', 'dropdown')">
						<mat-option *ngFor="let serviceType of serviceTypeFilter" [id]="serviceType.value"
							[value]="serviceType.value">{{serviceType.label}}</mat-option>
					</mat-select>
				</td>				
				<td style="width: 16%;padding: 10px;">
					<input [max]="today" matInput [matDatepicker]="fromPicker" style="width:80%;height:37px;"  (dateChange)="captureValue($event, 'fromDateTime', 'datepicker')">
					<mat-datepicker-toggle matSuffix [for]="fromPicker"></mat-datepicker-toggle>
					<mat-datepicker #fromPicker></mat-datepicker>
				</td>
				<td style="width: 16%;padding: 10px;">
					<input  matInput [matDatepicker]="toPicker" style="width:80%;height:37px;"  (dateChange)="captureValue($event, 'toDateTime', 'datepicker')">
					<mat-datepicker-toggle matSuffix [for]="toPicker"></mat-datepicker-toggle>
					<mat-datepicker #toPicker></mat-datepicker>
				</td>
				<td style="width: 16%;padding: 10px;">
					<mat-select multiple placeholder="{{'viewhistory.inputStatus' | translate}}"
						(selectionChange)="captureValue($event, 'statusFilter', 'dropdown')">
						<mat-option *ngFor="let status of statusTypeFilter" [id]="status.value" [value]="status.value">
							{{status.label}}</mat-option>
					</mat-select>
				</td>
				<td style="width: 20%;padding: 10px;"><button mat-raised-button color="primary" (click)="search()">{{'viewhistory.searchBtn' |
						translate}}</button>&nbsp;&nbsp;&nbsp;&nbsp;<button mat-raised-button color="default" (click)="downloadServiceHistory()"><img class="save-icon" src="./assets/images/save.png"/></button>
				</td>
			</tr>
		</table>
		<table *ngIf="responselist" style="width: 100%;border-collapse: separate;border-spacing: 1em;">
			<tr *ngFor="let data of responselist; let i = index" style="outline: thin solid silver;border-radius: 5px;"
				multi>
				<mat-expansion-panel>
					<mat-expansion-panel-header>
						<td style="width: 2%;padding: 10px;"><span *ngIf="data.pinnedStatus === 'true'"><img
									src="assets\pin.png" style="color: green;width: 8px;"></span></td>
						<td style="width: 33%;padding: 10px;color: #008CED;"><span>{{'viewhistory.inputAppId' | translate}} :
							</span>{{data.eventId}}</td>
						<td style="width: 39%;padding: 10px;"><span>{{'viewhistory.description' | translate}} : </span>{{data.description}}</td>
						<td style="width: 13%;padding: 10px;"><!-- <span>{{'viewhistory.timestamp' | translate}} : </span> -->{{data.timeStamp | date:'dd/MM/yyyy hh:mm'}}</td>
						<td style="width: 13%;padding: 10px;"><!-- <span>{{'viewhistory.inputStatus' | translate}} : </span> -->{{data.eventStatus}}</td>
					</mat-expansion-panel-header>
					<p style="width: 100%;padding: 10px 35px;">
						<span style="cursor:pointer;" (click)="reportDetails(data)"><img src="assets\report.png"
								style="color: green;width: 15px;">&nbsp;&nbsp;&nbsp;<span
								style="font-size:12px;color:#505050;">Report an
								issue&nbsp;&nbsp;&nbsp;&nbsp;</span>|&nbsp;&nbsp;&nbsp;&nbsp;</span>
						<span style="cursor:pointer;" *ngIf="data.pinnedStatus === 'false'" (click)="pinData(data)"><img
								src="assets\pin.png" style="color: green;width: 8px;">&nbsp;&nbsp;&nbsp;<span
								style="font-size:12px;color:#505050;">Pin to
								top&nbsp;&nbsp;&nbsp;&nbsp;</span>|&nbsp;&nbsp;&nbsp;&nbsp;</span>
						<span style="cursor:pointer;" *ngIf="data.pinnedStatus === 'true'"
							(click)="unpinData(data)"><img src="assets\pin.png"
								style="color: green;width: 8px;">&nbsp;&nbsp;&nbsp;<span
								style="font-size:12px;color:#505050;">Unpin from
								top&nbsp;&nbsp;&nbsp;&nbsp;</span>|&nbsp;&nbsp;&nbsp;&nbsp;</span>
						<span style="cursor:pointer;" (click)="viewDetails(data)"><img src="assets\view.png"
								style="color: green;width: 15px;">&nbsp;&nbsp;&nbsp;<span
								style="font-size:12px;color:#505050;">View Details</span></span>
					</p>
				</mat-expansion-panel>
			</tr>
		</table>
		<div dir="ltr">
			<span *ngIf="this.totalItems !== 0">
				<mat-paginator [length]="this.totalItems" [pageSize]="this.pageSize"
					[pageSizeOptions]="this.pageSizeOptions" (page)="getServiceHistory(pageEvent = $event)">
				</mat-paginator>
			</span>
		</div>
	</mat-card>
</div>